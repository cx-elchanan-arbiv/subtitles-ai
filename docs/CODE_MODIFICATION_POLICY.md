# 🚨 מדיניות שינוי קוד - חובה לקרוא!

## ⚠️ **כלל זהב: שאל לפני שינוי!**

**אזהרה לכל מפתח/AI:** קוד שכבר עובד ונבדק לא לשנות בלי אישור מפורש!

## 🛡️ **דברים שאסור לשנות ללא אישור:**

### 1. **מבנה הפרויקט הפשוט**
```
SubsTranslator/
├── backend/              # ✅ עובד מצוין - אל תזיז!
├── frontend/             # ✅ עובד מצוין - אל תזיז!
├── docker-compose.yml    # ✅ בשורש - אל תזיז למחיצות!
├── backend.Dockerfile    # ✅ בשורש - אל תזיז!
├── frontend.Dockerfile   # ✅ בשורש - אל תזיז!
├── start.sh             # ✅ עובד - אל תשנה!
├── stop.sh              # ✅ עובד - אל תשנה!
└── e2e_subtitle_test.py # ✅ בשורש - אל תזיז!
```

**🚫 אסור ליצור:** `deployment/`, `scripts/`, `tests/` directories
**✅ מותר רק:** הוספת קבצי documentaion במקום שלא יפריע

### 2. **קבצי Docker שעובדים**
- `docker-compose.yml` - כל ה-services רצים מצוין
- `backend.Dockerfile` - builds בהצלחה  
- `frontend.Dockerfile` - builds בהצלחה
- `nginx.conf` - routing עובד

**🚫 אל תשנה:** build context, paths, service names

### 3. **API Endpoints שעובדים**
- `/youtube` - מקבל JSON ומחזיר task_id
- `/status/{task_id}` - מחזיר progress ותוצאות
- `/download/{filename}` - מוריד קבצים
- `/health` - בדיקת סטטוס

**🚫 אל תשנה:** request/response format, parameter names

### 4. **תהליך העיבוד המלא**
- הורדת YouTube ✅
- תמלול עם Whisper ✅  
- תרגום עם Google Translate ✅
- יצירת וידאו עם כתוביות ✅
- הוספת לוגו/watermark ✅
- ניקוי שמות קבצים ✅

**🚫 אל תשנה:** שרשרת הטאסקים, timing, חישובי progress

### 5. **טסטים שעוברים**
- `test_app.py` - 3/3 עוברים ✅
- API manual tests עובדים ✅
- E2E test structure ✅

**🚫 אל תשנה:** טסטים שעוברים בלי סיבה טובה מאוד

## 🔍 **לפני כל שינוי - בדוק:**

### 1. **האם זה באמת צריך לשנות?**
- ✅ זה תוקן באג קריטי
- ✅ זה מוסיף פיצ'ר חדש בלי לשבור הקיים
- ❌ זה "יותר נקי" (עלול לשבור!)
- ❌ זה "יותר organized" (גרם לנו בעיות!)

### 2. **האם אני מבין למה הקוד הנוכחי נכתב ככה?**
- ✅ קראתי את ההיסטוריה של השינויים  
- ✅ הבנתי את הבעיות שהקוד הנוכחי פותר
- ✅ יש לי סיבה מבוססת לשינוי
- ❌ "זה נראה לי לא נכון" (לא מספיק!)

### 3. **שאלות חובה לפני שינוי:**
1. מה הבעיה הספציפית שאני מנסה לפתור?
2. למה הקוד הנוכחי לא פותר את זה?
3. איך השינוי שלי לא ישבור את מה שעובד?
4. האם בדקתי שהכל עובד אחרי השינוי?

## 📋 **תהליך שינוי חובה:**

### שלב 1: הכנה
```bash
# ודא שהמערכת עובדת לפני השינוי:
./start.sh
curl http://localhost:8081/health
curl -X POST -H "Content-Type: application/json" \
  -d '{"url":"https://www.youtube.com/watch?v=DzjrqYn0do8","target_lang":"he","auto_create_video":true,"whisper_model":"tiny"}' \
  http://localhost:8081/youtube
```

### שלב 2: שאל אישור (חובה!)
```
לפני שינוי שאל:
"אני רוצה לשנות [מה שאני רוצה לשנות] 
כי [הסיבה הספציפית].
הקוד הנוכחי [מה שהוא עושה כעת].  
השינוי שלי [מה שהוא יעשה אחרת].
האם זה בסדר?"
```

### שלב 3: שינוי זהיר
- שנה קובץ אחד בכל פעם
- בדוק אחרי כל שינוי שהכל עובד
- תעד מה שינית ולמה

### שלב 4: בדיקה מלאה
```bash
# הרץ טסטים:
docker exec substranslator-backend-1 python3 -m pytest /app/test_app.py -v

# בדוק API:
curl http://localhost:8081/health

# בדוק תהליך מלא:
[test full YouTube processing]
```

## 🚫 **אל תעשה - דוגמאות מהעבר:**

### ❌ רפקטורינג "מסודר":
```
BAD: יצירת deployment/, scripts/, tests/
תוצאה: Docker לא עבד, נתיבים נשברו, טסטים נפלו
```

### ❌ "שיפור" מבנה טסטים:
```  
BAD: העברת טסטים למחיצות נפרדות
תוצאה: import paths נשברו, pytest לא מצא קבצים
```

### ❌ "ניקוי" Docker files:
```
BAD: העברת docker-compose.yml למחיצת deployment/
תוצאה: build context שבר, nginx.conf לא נמצא
```

## ✅ **מה כן מותר לעשות:**

### 1. הוספת documentaion:
- README updates ✅
- הוספת מדריכים ✅  
- הוספת comments בקוד ✅

### 2. תיקון באגים קריטיים:
- תיקון שגיאות שמונעות פעולה ✅
- תיקון security issues ✅
- תיקון memory leaks ✅

### 3. הוספת פיצ'רים חדשים:
- בתנאי שלא משנים הקיים ✅
- עם בדיקות מלאות ✅
- עם אישור מראש ✅

## 🎯 **זכור תמיד:**

### "תמיד שאל לפני שינוי!"

1. **המערכת עובדת מצוין** - כל הטסטים עוברים
2. **המבנה פשוט ויעיל** - למדנו שמורכבות = בעיות  
3. **Docker builds בהצלחה** - אחרי הרבה trial & error
4. **API יציב ומהיר** - עבד בכל הבדיקות
5. **התיעוד מלא ומעודכן** - הכל מתועד היטב

### **חוק הברזל: שאל לפני שינוי!**

גם אם אתה בטוח ב-100% שהשינוי נכון - **שאל קודם!**

---

## 📞 **איך לשאול אישור:**

```
שאלה טובה:
"אני רואה ש[תיאור הבעיה הספציפית].
הקוד הנוכחי עושה [X] ב-[מיקום מדויק].
אני מציע לשנות ל-[Y] כי [סיבה מפורטת].
השינוי הזה לא ישפיע על [רשימת דברים שלא ישתנו].
האם זה בסדר לבצע את השינוי?"
```

```
שאלה רעה:
"אני רוצה לנקות את הקוד"
"זה נראה לי לא נכון"  
"בואו נעשה רפקטורינג"
```

---

**⚠️ הפרה של המדיניות הזו תביא לביטול כל השינויים וחזרה לגרסה עובדת!**

**📝 מסמך זה יתעדכן כל פעם שנלמד משהו חדש על מה לא לשנות.**
