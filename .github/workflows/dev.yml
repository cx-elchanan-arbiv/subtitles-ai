name: Dev

# ×”×¨×¥ ×¢×œ ×¤×•×©×™× ×œ×¢× ×¤×™× ××—×¨×™× (×œ× main)
on:
  push:
    branches-ignore: [ main ]
  workflow_dispatch: # ××¤×©×¨×•×ª ×œ×”×¨×™×¥ ×™×“× ×™×ª

jobs:
  quick-tests:
    name: Quick Unit Tests Only
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout Code
      uses: actions/checkout@v4
      
    - name: ðŸ Setup Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: '3.12'
        
    - name: ðŸ“¦ Setup Node.js 20
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
        cache-dependency-path: ./frontend/package-lock.json
        
    - name: ðŸ“¦ Install Backend Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r backend/requirements.txt
        pip install -r requirements-test.txt
        pip install -e backend/
        
    - name: ðŸ“¦ Install Frontend Dependencies
      working-directory: ./frontend
      run: npm ci
      
    - name: ðŸ§ª Quick Backend Tests
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
      run: |
        echo "ðŸ”§ Running Backend Unit Tests..."
        python -m pytest backend/tests/unit/ -x --tb=short -q -m unit
        
    - name: ðŸ§ª Quick Frontend Tests
      working-directory: ./frontend
      run: |
        echo "ðŸŽ¨ Running Frontend Unit Tests..."
        npm test -- --watchAll=false --silent
        
    - name: âœ… Quick Tests Summary
      run: |
        echo "### âš¡ Quick Tests Summary" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Backend Unit Tests: Passed" >> $GITHUB_STEP_SUMMARY
        echo "- âœ… Frontend Unit Tests: Passed" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "ðŸš€ **Ready for development!**" >> $GITHUB_STEP_SUMMARY
